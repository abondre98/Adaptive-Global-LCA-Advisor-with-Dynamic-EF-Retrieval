2025-03-11 23:01:42,219 - __main__ - INFO - Starting Adaptive Global LCA Advisor data extraction and processing
2025-03-11 23:01:42,219 - __main__ - INFO - Starting extraction process for all datasets
2025-03-11 23:01:42,219 - __main__ - INFO - Found 6 extractor modules: ipcc_extractor, useeio_extractor, ipcc_ar6_extractor, climate_trace_extractor, agribalyse_extractor, exiobase_extractor
2025-03-11 23:01:42,219 - __main__ - INFO - Running extractor: ipcc_extractor
2025-03-11 23:01:42,246 - utils - INFO - [IPCC] Getting report links
2025-03-11 23:01:43,569 - extractors.ipcc_extractor - WARNING - No report links found, using predefined multipliers only
2025-03-11 23:01:43,570 - utils - INFO - [IPCC] Extracting predefined multipliers
2025-03-11 23:01:43,570 - utils - INFO - [IPCC] Combining multipliers
2025-03-11 23:01:43,572 - utils - INFO - [IPCC] Cleaning dataset
2025-03-11 23:01:43,574 - utils - INFO - Saved DataFrame with 10 rows to data/processed/ipcc_ar6_multipliers.csv
2025-03-11 23:01:43,576 - utils - INFO - Created checksum a5cdc23176c88a29562b0ec248b0e592 for data/processed/ipcc_ar6_multipliers.csv
2025-03-11 23:01:43,577 - extractors.ipcc_extractor - INFO - Cleaned dataset has 10 rows
2025-03-11 23:01:43,577 - extractors.ipcc_extractor - INFO - IPCC AR6 extraction and cleaning completed: data/processed/ipcc_ar6_multipliers.csv
2025-03-11 23:01:43,577 - __main__ - INFO - Completed ipcc_extractor in 1.36 seconds
2025-03-11 23:01:43,577 - __main__ - INFO - Running extractor: useeio_extractor
2025-03-11 23:01:43,615 - utils - INFO - [USEEIO] Cloning repository
2025-03-11 23:01:43,615 - extractors.useeio_extractor - INFO - USEEIO repository already exists at data/raw/useeio
2025-03-11 23:01:43,827 - extractors.useeio_extractor - INFO - Pulled latest changes from repository
2025-03-11 23:01:43,827 - utils - INFO - [USEEIO] Finding relevant files
2025-03-11 23:01:43,829 - extractors.useeio_extractor - ERROR - Error in USEEIO extraction: No relevant emission factor files found in the repository
2025-03-11 23:01:43,829 - __main__ - ERROR - Error running extractor useeio_extractor: No relevant emission factor files found in the repository
Traceback (most recent call last):
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/main.py", line 101, in run_extractors
    cleaned_file = module.extract_and_clean()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/extractors/useeio_extractor.py", line 452, in extract_and_clean
    file_paths = find_relevant_files(repo_path)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/extractors/useeio_extractor.py", line 248, in find_relevant_files
    raise FileNotFoundError(
FileNotFoundError: No relevant emission factor files found in the repository
2025-03-11 23:01:43,830 - __main__ - INFO - Running extractor: ipcc_ar6_extractor
2025-03-11 23:01:43,830 - utils - INFO - [IPCC_AR6] Downloading data
2025-03-11 23:01:43,830 - extractors.ipcc_ar6_extractor - INFO - Using existing IPCC AR6 data from data/raw/ipcc_ar6_raw.json
2025-03-11 23:01:43,830 - utils - INFO - [IPCC_AR6] Processing data
2025-03-11 23:01:43,832 - extractors.ipcc_ar6_extractor - INFO - Processed 78 IPCC AR6 multipliers
2025-03-11 23:01:43,832 - utils - INFO - [IPCC_AR6] Converting to standard format
2025-03-11 23:01:43,833 - utils - INFO - [IPCC_AR6] Cleaning dataset
2025-03-11 23:01:43,835 - extractors.ipcc_ar6_extractor - INFO - Detected 0 outliers in multiplier values
2025-03-11 23:01:43,836 - utils - INFO - Saved DataFrame with 78 rows to data/processed/ipcc_ar6_clean.csv
2025-03-11 23:01:43,839 - utils - INFO - Created checksum c36ba1e83263c444595c83f60dadcbf7 for data/processed/ipcc_ar6_clean.csv
2025-03-11 23:01:43,839 - extractors.ipcc_ar6_extractor - INFO - Cleaned dataset has 78 rows
2025-03-11 23:01:43,839 - extractors.ipcc_ar6_extractor - INFO - IPCC AR6 extraction and cleaning completed: data/processed/ipcc_ar6_clean.csv
2025-03-11 23:01:43,839 - __main__ - INFO - Completed ipcc_ar6_extractor in 0.01 seconds
2025-03-11 23:01:43,839 - __main__ - INFO - Running extractor: climate_trace_extractor
2025-03-11 23:01:43,839 - utils - INFO - [CLIMATE_TRACE] Fetching all data
2025-03-11 23:01:43,840 - extractors.climate_trace_extractor - INFO - Using existing Climate TRACE data from data/raw/climate_trace_latest.json
2025-03-11 23:01:43,840 - utils - INFO - [CLIMATE_TRACE] Processing emissions data
2025-03-11 23:01:43,841 - extractors.climate_trace_extractor - INFO - Processed 50 emission records from Climate TRACE
2025-03-11 23:01:43,841 - utils - INFO - [CLIMATE_TRACE] Converting to EF format
2025-03-11 23:01:43,844 - utils - INFO - [CLIMATE_TRACE] Cleaning dataset
2025-03-11 23:01:43,844 - extractors.climate_trace_extractor - INFO - Detected 0 outliers in emission factor values
2025-03-11 23:01:43,846 - utils - INFO - Saved DataFrame with 50 rows to data/processed/climate_trace_clean.csv
2025-03-11 23:01:43,847 - utils - INFO - Created checksum 6eb6ab5d96e6a9ac198a040471344d3c for data/processed/climate_trace_clean.csv
2025-03-11 23:01:43,847 - extractors.climate_trace_extractor - INFO - Cleaned dataset has 50 rows
2025-03-11 23:01:43,847 - extractors.climate_trace_extractor - INFO - Climate TRACE extraction and cleaning completed: data/processed/climate_trace_clean.csv
2025-03-11 23:01:43,848 - __main__ - INFO - Completed climate_trace_extractor in 0.01 seconds
2025-03-11 23:01:43,848 - __main__ - INFO - Running extractor: agribalyse_extractor
2025-03-11 23:01:43,848 - utils - INFO - [AGRIBALYSE] Downloading dataset
2025-03-11 23:01:43,848 - extractors.agribalyse_extractor - INFO - Agribalyse dataset already exists at data/raw/agribalyse_3.1_raw.csv
2025-03-11 23:01:43,848 - utils - INFO - [AGRIBALYSE] Validating dataset
2025-03-11 23:01:43,849 - extractors.agribalyse_extractor - INFO - Successfully read file with encoding: utf-8
2025-03-11 23:01:43,849 - extractors.agribalyse_extractor - INFO - Found columns: LCI_Name, ProductName, PEF_categoria, Climate_change_-_total, Unit, DQR
2025-03-11 23:01:43,849 - extractors.agribalyse_extractor - INFO - Agribalyse dataset validation successful
2025-03-11 23:01:43,849 - utils - INFO - [AGRIBALYSE] Cleaning dataset
2025-03-11 23:01:43,849 - extractors.agribalyse_extractor - INFO - Successfully read file with encoding: utf-8
2025-03-11 23:01:43,849 - extractors.agribalyse_extractor - INFO - Raw dataset has 20 rows and 6 columns
2025-03-11 23:01:43,849 - extractors.agribalyse_extractor - INFO - Columns: LCI_Name, ProductName, PEF_categoria, Climate_change_-_total, Unit, DQR
2025-03-11 23:01:43,850 - extractors.agribalyse_extractor - INFO - Using column 'LCI_Name' as product name
2025-03-11 23:01:43,850 - extractors.agribalyse_extractor - INFO - Using column 'LCI_Name' as product ID
2025-03-11 23:01:43,850 - extractors.agribalyse_extractor - INFO - Using column 'PEF_categoria' as product category
2025-03-11 23:01:43,850 - extractors.agribalyse_extractor - INFO - Using column 'DQR' as data quality
2025-03-11 23:01:43,850 - extractors.agribalyse_extractor - INFO - Using column 'Unit' as unit
2025-03-11 23:01:43,850 - extractors.agribalyse_extractor - INFO - Using column 'Climate_change_-_total' as emission factor
2025-03-11 23:01:43,852 - extractors.agribalyse_extractor - INFO - Detected 0 outliers in emission factor values
2025-03-11 23:01:43,853 - utils - INFO - Saved DataFrame with 20 rows to data/processed/agribalyse_3.1_clean.csv
2025-03-11 23:01:43,854 - utils - INFO - Created checksum dd96241d9fbf22d0d5dc76303956ea6a for data/processed/agribalyse_3.1_clean.csv
2025-03-11 23:01:43,854 - extractors.agribalyse_extractor - INFO - Cleaned dataset has 20 rows
2025-03-11 23:01:43,854 - extractors.agribalyse_extractor - INFO - Agribalyse extraction and cleaning completed: data/processed/agribalyse_3.1_clean.csv
2025-03-11 23:01:43,854 - __main__ - INFO - Completed agribalyse_extractor in 0.01 seconds
2025-03-11 23:01:43,854 - __main__ - INFO - Running extractor: exiobase_extractor
2025-03-11 23:01:43,855 - utils - INFO - [EXIOBASE] Downloading dataset
2025-03-11 23:01:43,855 - extractors.exiobase_extractor - INFO - Attempting to download from: https://zenodo.org/records/5589597/files/EXIOBASE_3_8_2_2022_env.zip
2025-03-11 23:01:44,369 - extractors.exiobase_extractor - WARNING - Failed to download EXIOBASE: URL returned HTML or invalid response
2025-03-11 23:01:44,369 - utils - INFO - [EXIOBASE] Creating simulated dataset
2025-03-11 23:01:44,379 - extractors.exiobase_extractor - INFO - Created simulated EXIOBASE dataset with 1029 entries
2025-03-11 23:01:44,379 - utils - INFO - [EXIOBASE] Extracting files
2025-03-11 23:01:44,379 - extractors.exiobase_extractor - INFO - EXIOBASE files already extracted to data/raw/exiobase_3.8
2025-03-11 23:01:44,379 - utils - INFO - [EXIOBASE] Finding emission tables
2025-03-11 23:01:44,380 - extractors.exiobase_extractor - INFO - Found emission table: data/raw/exiobase_3.8/emissions_by_country_product.csv
2025-03-11 23:01:44,380 - utils - INFO - [EXIOBASE] Parsing emission tables
2025-03-11 23:01:44,388 - extractors.exiobase_extractor - INFO - Parsed table data/raw/exiobase_3.8/emissions_by_country_product.csv with 1029 rows
2025-03-11 23:01:44,392 - utils - INFO - [EXIOBASE] Extracting emission factors
2025-03-11 23:01:44,392 - extractors.exiobase_extractor - INFO - Using column 'CO2_Emissions' for emission factors
2025-03-11 23:01:44,394 - utils - INFO - [EXIOBASE] Standardizing country codes
2025-03-11 23:01:44,396 - utils - INFO - [EXIOBASE] Cleaning dataset
2025-03-11 23:01:44,399 - extractors.exiobase_extractor - INFO - Detected 23 outliers in emission factor values
2025-03-11 23:01:44,403 - utils - INFO - Saved DataFrame with 1029 rows to data/processed/exiobase_3.8_clean.csv
2025-03-11 23:01:44,417 - utils - INFO - Created checksum ecdc4caf6c943ef43021f4ec879213f1 for data/processed/exiobase_3.8_clean.csv
2025-03-11 23:01:44,417 - extractors.exiobase_extractor - INFO - Cleaned dataset has 1029 rows
2025-03-11 23:01:44,417 - extractors.exiobase_extractor - INFO - EXIOBASE extraction and cleaning completed: data/processed/exiobase_3.8_clean.csv
2025-03-11 23:01:44,417 - __main__ - INFO - Completed exiobase_extractor in 0.56 seconds
2025-03-11 23:01:44,417 - __main__ - INFO - Successfully extracted and cleaned 5 datasets
2025-03-11 23:01:44,417 - __main__ - INFO - Starting harmonization process
2025-03-11 23:01:44,421 - utils - INFO - [HARMONIZATION] Loading datasets
2025-03-11 23:01:44,422 - harmonization.harmonizer - INFO - Loaded ipcc dataset with 10 rows
2025-03-11 23:01:44,423 - harmonization.harmonizer - INFO - Loaded ipcc_ar6 dataset with 78 rows
2025-03-11 23:01:44,424 - harmonization.harmonizer - INFO - Loaded climate_trace dataset with 50 rows
2025-03-11 23:01:44,425 - harmonization.harmonizer - INFO - Loaded agribalyse dataset with 20 rows
2025-03-11 23:01:44,427 - harmonization.harmonizer - INFO - Loaded exiobase dataset with 1029 rows
2025-03-11 23:01:44,427 - utils - INFO - [HARMONIZATION] Creating entity crosswalk
2025-03-11 23:01:44,449 - harmonization.harmonizer - INFO - Created entity crosswalk with 1008 matches
2025-03-11 23:01:44,449 - utils - INFO - [HARMONIZATION] Standardizing units
2025-03-11 23:01:44,450 - harmonization.harmonizer - INFO - Keeping 78 ratio values as-is in ipcc_ar6
2025-03-11 23:01:44,450 - harmonization.harmonizer - INFO - Converting 50 values from kg CO2e to kg CO2e in climate_trace
2025-03-11 23:01:44,450 - harmonization.harmonizer - INFO - Converting 50 values from g CO2e to kg CO2e in climate_trace
2025-03-11 23:01:44,451 - harmonization.harmonizer - INFO - Converting 20 values from kg CO2e to kg CO2e in agribalyse
2025-03-11 23:01:44,451 - harmonization.harmonizer - INFO - Converting 20 values from g CO2e to kg CO2e in agribalyse
2025-03-11 23:01:44,452 - harmonization.harmonizer - INFO - Converting 1029 values from kg CO2e to kg CO2e in exiobase
2025-03-11 23:01:44,452 - harmonization.harmonizer - INFO - Converting 1029 values from g CO2e to kg CO2e in exiobase
2025-03-11 23:01:44,453 - utils - INFO - [HARMONIZATION] Applying regional multipliers
2025-03-11 23:01:44,455 - harmonization.harmonizer - INFO - Applied regional multipliers to 0 records in ipcc
2025-03-11 23:01:44,456 - harmonization.harmonizer - INFO - Applied regional multipliers to 0 records in climate_trace
2025-03-11 23:01:44,456 - harmonization.harmonizer - INFO - Applied regional multipliers to 0 records in agribalyse
2025-03-11 23:01:44,472 - harmonization.harmonizer - INFO - Applied regional multipliers to 0 records in exiobase
2025-03-11 23:01:44,473 - utils - INFO - [HARMONIZATION] Merging datasets
2025-03-11 23:01:44,475 - harmonization.harmonizer - ERROR - Error in harmonization process: Expecting value: line 1 column 2 (char 1)
Traceback (most recent call last):
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/harmonization/harmonizer.py", line 447, in harmonize
    merged_df = merge_datasets(adjusted_datasets)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/harmonization/harmonizer.py", line 363, in merge_datasets
    merged_df["tags"] = merged_df["tags"].apply(
                        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/series.py", line 4764, in apply
    ).apply()
      ^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/apply.py", line 1209, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/apply.py", line 1289, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/base.py", line 921, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/algorithms.py", line 1814, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib.pyx", line 2926, in pandas._libs.lib.map_infer
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/harmonization/harmonizer.py", line 365, in <lambda>
    json.loads(x)
  File "/opt/anaconda3/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 2 (char 1)
2025-03-11 23:01:44,517 - __main__ - ERROR - Error in harmonization process: Expecting value: line 1 column 2 (char 1)
Traceback (most recent call last):
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/main.py", line 133, in run_harmonization
    harmonized_file = harmonization_module.harmonize(cleaned_datasets, FINAL_OUTPUT)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/harmonization/harmonizer.py", line 447, in harmonize
    merged_df = merge_datasets(adjusted_datasets)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/harmonization/harmonizer.py", line 363, in merge_datasets
    merged_df["tags"] = merged_df["tags"].apply(
                        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/series.py", line 4764, in apply
    ).apply()
      ^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/apply.py", line 1209, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/apply.py", line 1289, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/base.py", line 921, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/algorithms.py", line 1814, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib.pyx", line 2926, in pandas._libs.lib.map_infer
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/harmonization/harmonizer.py", line 365, in <lambda>
    json.loads(x)
  File "/opt/anaconda3/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 2 (char 1)
2025-03-11 23:01:44,517 - __main__ - ERROR - Error in main process: Expecting value: line 1 column 2 (char 1)
Traceback (most recent call last):
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/main.py", line 232, in main
    harmonized_file = run_harmonization(cleaned_datasets)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/main.py", line 133, in run_harmonization
    harmonized_file = harmonization_module.harmonize(cleaned_datasets, FINAL_OUTPUT)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/harmonization/harmonizer.py", line 447, in harmonize
    merged_df = merge_datasets(adjusted_datasets)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/harmonization/harmonizer.py", line 363, in merge_datasets
    merged_df["tags"] = merged_df["tags"].apply(
                        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/series.py", line 4764, in apply
    ).apply()
      ^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/apply.py", line 1209, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/apply.py", line 1289, in apply_standard
    mapped = obj._map_values(
             ^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/base.py", line 921, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/site-packages/pandas/core/algorithms.py", line 1814, in map_array
    return lib.map_infer(values, mapper, convert=convert)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib.pyx", line 2926, in pandas._libs.lib.map_infer
  File "/Users/surendra/Desktop/Carbon EF/data/scripts/harmonization/harmonizer.py", line 365, in <lambda>
    json.loads(x)
  File "/opt/anaconda3/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 2 (char 1)
